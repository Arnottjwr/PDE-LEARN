`PDE-LEARN` is a PDE discovery algorithm that was developed by Robert Stephany and Christopher Earls at Cornell University. It can identify a wide variety of linear and non-linear Partial Differential Equations (PDEs) directly from noisy and limited data. This `READ-ME` explains how to use `PDE-LEARN`. Throughout this document, we assume the reader is familiar with the `PDE-LEARN` algorithm. For a full description of the algorithm, please see the paper *PDE-LEARN: Using Deep Learning to Discover Partial Differential Equations from Noisy, Limited Data*.  If you have a questions about our approach and can not find the answer in this document or the paper, either send your question to the correspond author at *rrs254@cornell.edu*, or consult the code directly (all of which is thoroughly commented).

# Library structure
The `PDE-LEARN` repository is split into several sub-directories and files. For most users, the most important of these are the files `Settings.txt` and `Library.txt`, both of which are located in the repository's main directory. `Settings.txt` houses the settings that control how `PDE-LEARN` operates, while `Library.txt` specifies the left and right-hand side terms. When `PDE-LEARN` runs, it parses the contents of `Settings.txt` and `Library.txt` and then uses the values it reads to identify a PDE. **Below, we how to set up these files.** These two files completely control `PDE-LEARN`. As a result, you should not modify the underlying source code. If you want to use `PDE-LEARN` in a way that does not appear possible using the settings in `Setting.txt`, you are welcome to modify the code as you feel fit; though the authors will not be able to help you debug any changes you make.

*Code:* 
This directory houses `PDE-LEARN`'s source code. All of our code is fully commented. Feel free to look through our code to understand how `PDE-LEARN` works "under the hood".  If you think you've found a bug in our code, please let us know! `PDE-LEARN`'s source code is split over several files. 

The `main.py` file is the one that you should call when you want to run `PDE-LEARN` (see below). This file reads the settings and library, sets up the networks, trains them, and then saves the results. It drives the rest of the code.

The file `Data.py` loads a saved data set (in the `.npz` file format, see the *Data:* section below for more details).

The `Evaluated_Derivatives.py` file houses code that can compute $D_a U$ from $D_b U$ where $D_a$ and $D_b$ are partial derivative operators and $U$ is a neural network. This function assumes that $D_b$ is a "child derivative" of $D_a$, which essentially means that every partial derivative that appears in $D_b$ also appear in $D_a$, and have at least the same order. If $D_a$ is "child derivative" of $D_a$, then it is possible to compute $D_a U$ from $D_b U$ by applying additional partial derivatives to $D_b U$. 

The `Loss.py` file houses code that computes the data, collocation, and $L^p$ losses. The collocation loss function computes the partial derivatives of $U$ using the `Evaluate_Derivatives` function. It does this by first evaluating the lowest order partial derivatives of $U$, and then computing higher order partial derivatives of $U$ from these. This approach minimizes the number of computations required to evaluate the library terms.

The `Plot.py` function houses code to plot loss histories. Each time that the user runs `PDE-LEARN`, it produces plots that depict the loss history of the three loss functions of $U$, as well as the total $L^2$ loss of $U$'s paramaters, and the total loss. These plots are saved into the `Figures` directory.

`Points.py` houses a function that generates the random collocation points.

Finally, `Test_Train.py` houses two functions: `Testing` and `Training`. The former evaluates the network/library's performance on a tata set, but does not update the network's parameters or components of $\xi$. The `Training` function implements on epoch of training.

The `Classes` sub-directory houses definitions of the various classes that `PDE-LEARN` uses.

Finally, the `Readers` sub-directory houses code that parses `Settings.txt` and `Library.txt`

*Data:* 
`PDE-LEARN` trains $U$ to match a data set. The "DataSet Names" setting specifies the data sets that `PDE-LEARN` trains on. "DataSet Names" should be a list of strings specifying files that are in the folder `Data/DataSets` directory. A "DataSet" is simply a `.npz` file that contains a dictionary with six keys: "Training Inputs", "Training Targets", "Testing Inputs", "Testing Targets", "Bounds" and "Number of Dimensions." Each of these keys refers to a `numpy.ndarray` object (except "Number of Dimensions", which is just an integer specifying the number of spatial dimensions in the inputs in the data set). If you want to use `PDE-LEARN` on your data, you must write a program that calls the `Create_Data_Set` function (in `Create_Data_Set.py`) with the appropriate arguments. See that function's docstring for details. Alternatively, you can create a DataSet using one of our `MATLAB` data sets by running `Python3 ./From_MATLAB.py` when your current working directory is `Data`. The `From_MATLAB` file contains five settings: "Data_File_Name", "Num_Spatial_Dimensions", "Noise_Proportion", "Num_Train_Examples", and "Num_Test_Examples". "Data_File_Name" should refer to one of the `.mat` files in the `MATLAB/Data` directory. "Num_Spatial_Dimensions" specifies the number of spatial dimensions in the inputs stored in the `.mat` file. "Noise_Proportion", "Num_Train_Examples", and "Num_Test_Examples" control the level of noise in the data, the number of training data points, and the number of testing data points, respectively.

*Plot:* 
Visualizing $U$ after `PDE-LEARN` trains it can be very useful. The `Plot` directory contains code for visualizing the networks that `PDE-LEARN` trains. Plotting is controlled by the `Plot/Settings.txt` file. This file has just two settings: "Load File Name" and "Mat File Names." The former specifies the name of the save that you want to visualize (this is the file that `PDE-LEARN` saves the trained $U$ network to after training). The latter specifies the name of the `.mat` file that houses the noise-free data set corresponding to the data set that you trained $U$ trained on. Critically, the "Load File Name" setting must refer to a file in `Saves`. To plot a saved solution, set the appropriate settings in `Plot/Settings.txt` and then run `Python3 ./Plot_Solution.py` when your current working directory is `Plot.`

*Everything else:* 
The other directories in this repository are as follows: `Figures` houses the loss-history plots produced by `PDE-LEARN`, as well as the plots that `Plot_Solution.py` makes. Saves houses serializations of the networks that `PDE-LEARN` runs ("Load File Name" in `Settings.txt` and `Plot/Settings.txt` must refer to a file in this directory). `Test` contains test code that I used while developing `PDE-LEARN`. `MATLAB` contains the `MATLAB` data sets (the `.mat` files in `MATLAB/Data`), and the scripts that created them (the `.m` files in `MATLAB/Scripts`).
